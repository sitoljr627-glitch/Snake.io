<!DOCTYPE html>
<html>
<head>
<title>Snake Game + Score</title>
<style>
  body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#111;
    color:white;
    font-family:Arial;
    flex-direction:column;
  }

  canvas{
    background:#1b1b1b;
    border:3px solid white;
  }
</style>
</head>

<body>

<h1>Snake Game</h1>
<canvas id="gameCanvas" width="400" height="400"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let grid = 20;
let snake = [{x:200, y:200}];
let dx = grid;
let dy = 0;

let food = randomFood();

let score = 0;
let highscore = localStorage.getItem("snakeHighscore") || 0;

function randomFood(){
  return {
    x: Math.floor(Math.random() * (canvas.width / grid)) * grid,
    y: Math.floor(Math.random() * (canvas.height / grid)) * grid
  };
}

let slow = 0;
function gameLoop(){
  requestAnimationFrame(gameLoop);

  if(++slow < 6) return;
  slow = 0;

  ctx.fillStyle = "black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  let head = { x: snake[0].x + dx, y: snake[0].y + dy };

  // nabrak dinding = restart
  if(head.x < 0 || head.y < 0 || head.x >= canvas.width || head.y >= canvas.height){
    resetGame();
    return;
  }

  snake.unshift(head);

  // kalau makan
  if(head.x === food.x && head.y === food.y){
    food = randomFood();
    score++;

    if(score > highscore){
      highscore = score;
      localStorage.setItem("snakeHighscore", highscore);
    }

  } else {
    snake.pop();
  }

  // gambar ular
  ctx.fillStyle = "lime";
  snake.forEach(s => ctx.fillRect(s.x,s.y,grid,grid));

  // gambar makanan
  ctx.fillStyle = "red";
  ctx.fillRect(food.x, food.y, grid, grid);

  // teks score
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, 10, 25);
  ctx.fillText("Highscore: " + highscore, 10, 50);
}

function resetGame(){
  snake = [{x:200, y:200}];
  dx = grid;
  dy = 0;
  food = randomFood();
  score = 0;
}

gameLoop();

// kontrol
window.addEventListener("keydown", e =>{
  if((e.key === "ArrowUp" || e.key === "w") && dy === 0){ dy = -grid; dx = 0; }
  if((e.key === "ArrowDown" || e.key === "s") && dy === 0){ dy = grid; dx = 0; }
  if((e.key === "ArrowLeft" || e.key === "a") && dx === 0){ dx = -grid; dy = 0; }
  if((e.key === "ArrowRight" || e.key === "d") && dx === 0){ dx = grid; dy = 0; }
});
</script>

</body>
</html>
